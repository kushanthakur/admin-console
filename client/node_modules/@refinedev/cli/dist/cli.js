#!/usr/bin/env node
var Xt=Object.create;var ae=Object.defineProperty;var Yt=Object.getOwnPropertyDescriptor;var Kt=Object.getOwnPropertyNames;var Gt=Object.getPrototypeOf,Zt=Object.prototype.hasOwnProperty;var Qt=(e,t)=>{for(var r in t)ae(e,r,{get:t[r],enumerable:!0})},er=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Kt(t))!Zt.call(e,o)&&o!==r&&ae(e,o,{get:()=>t[o],enumerable:!(n=Yt(t,o))||n.enumerable});return e};var p=(e,t,r)=>(r=e!=null?Xt(Gt(e)):{},er(t||!e||!e.__esModule?ae(r,"default",{value:e,enumerable:!0}):r,e));var Mt=require("commander"),Wt=p(require("figlet"));var ze=p(require("react")),Fe=require("ink");var _=require("fs-extra"),ke=p(require("globby")),ce=p(require("execa")),ve=p(require("preferred-pm"));var Se=p(require("ora")),tr=async(e,t)=>{let r=(0,Se.default)({color:"cyan",text:t}).start(),n=await e();return r.stop(),n},F=tr;var J=()=>{if(!(0,_.existsSync)("package.json"))throw new Error("./package.json not found");return JSON.parse((0,_.readFileSync)("package.json","utf8"))},q=()=>{let e=J();return Object.keys(e.dependencies||{})};var be=()=>{let e=J();return Object.keys(e.devDependencies||{})},ee=()=>J().scripts,V=async()=>{var e;try{let t=await(0,ce.default)("npm",["ls","--depth=0","--json"],{reject:!1}),r=((e=JSON.parse(t.stdout))==null?void 0:e.dependencies)||{},n=Object.keys(r).filter(s=>s.startsWith("@refinedev")),o=[];for(let s of n){let m=r[s].version;o.push({name:s,version:m})}return o}catch{return Promise.resolve(null)}},Ne=async()=>{try{let e=await(0,ke.default)("node_modules/@refinedev/*",{onlyDirectories:!0}),t=[];return await Promise.all(e.map(async r=>{if(await(0,_.pathExists)(`${r}/package.json`)){let o=await(0,_.readJSON)(`${r}/package.json`);t.push({name:o.name,path:r})}})),t}catch{return[]}},Oe=async e=>await(0,_.pathExists)(`${e}/refine.config.js`),X={npm:{install:["install","--save"],installDev:["install","--save-dev"],outdatedJson:["outdated","--json"]},yarn:{install:["add"],installDev:["add","-D"],outdatedJson:["outdated","--json"]},pnpm:{install:["add"],installDev:["add","-D"],outdatedJson:["outdated","--format","json"]}},R=async()=>{let e=await F(()=>(0,ve.default)(process.cwd()),"Getting package manager...");if(!e)throw new Error("Package manager not found.");return e},_e=async e=>{let t=await R();try{let r=X[t.name].install,n=(0,ce.default)(t.name,[...r,...e],{stdio:"inherit"});n.on("message",o=>{console.log(o)}),n.on("error",o=>{console.log(o)}),n.on("exit",o=>{if(o===0){console.log("All `refine` packages updated  \u{1F389}");return}console.log(`Application exited with code ${o}`)})}catch(r){throw new Error(r)}},De=e=>{let t=e.lastIndexOf("@");return t<=0?{name:e,version:null}:{name:e.slice(0,t),version:e.slice(t+1)}};var T=p(require("react")),$e=p(require("ink-table")),P=require("ink"),je={name:1,current:2,wanted:3,latest:4},rr=4,pe=e=>{let t=e.split(".");return{major:t[0],minor:t[1],patch:t[2]}},Ae=(e,t)=>e.major.trim()!==t.major.trim()?{major:"red",minor:"red",patch:"red"}:e.minor.trim()!==t.minor.trim()?{major:"white",minor:"yellow",patch:"yellow"}:e.patch.trim()!==t.patch.trim()?{major:"white",minor:"white",patch:"green"}:{major:"white",minor:"white",patch:"white"},or=({data:e,command:t})=>{let r=(0,T.useRef)(1),n=(0,T.useRef)(0);return T.default.createElement(P.Box,{width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center"},T.default.createElement(P.Text,null,"Update Available"),T.default.createElement($e.default,{data:e,cell:o=>{var h;let s=T.default.createElement(P.Text,null,o.children),m=(h=o.children)==null?void 0:h.toString();if(!m)return s;let f=pe(e[n.current].current);if(r.current===je.wanted){let a=pe(m),l=Ae(f,a);s=T.default.createElement(Re,{major:{color:l.major,text:a.major},minor:{color:l.minor,text:a.minor},patch:{color:l.patch,text:a.patch}})}if(r.current===je.latest){let a=pe(m),l=Ae(f,a);s=T.default.createElement(Re,{major:{color:l.major,text:a.major},minor:{color:l.minor,text:a.minor},patch:{color:l.patch,text:a.patch}})}return r.current===rr?(n.current+=1,r.current=1):r.current+=1,s}}),T.default.createElement(P.Text,null,"To update ",T.default.createElement(P.Text,{bold:!0},"`refine`")," packages with the wanted version"),T.default.createElement(P.Text,null,"Run the following command"," ",T.default.createElement(P.Text,{color:"yellowBright"},t)))},Re=({major:e,minor:t,patch:r})=>T.default.createElement(P.Text,null,T.default.createElement(P.Text,{color:e.color},e.text),T.default.createElement(P.Text,{color:t.color},".",t.text,"."),T.default.createElement(P.Text,{color:r.color},r.text)),Ue=or;var nr=async()=>{let e="npx @refinedev/cli update",t=q(),r=Object.keys(ee()),n=t.includes("@refinedev/cli"),o=r.includes("refine");if(!n&&!o)return e;let s=await R();return o?`${s.name} run refine update`:n?"npx refine update":e},te=async e=>{let t=await nr();(0,Fe.render)(ze.default.createElement(Ue,{data:e,command:t}))};var Ve=p(require("execa"));var Be=p(require("semver-diff")),sr=e=>e.command("check-updates").description("Check all installed `refine` packages are up to date").action(ir),ir=async()=>{let e=await F(Y,"Checking for updates...");if(!e.length){console.log("All `refine` packages are up to date \u{1F389}\n");return}await te(e)},Y=async()=>await ar(),ar=async()=>{let e=await cr();if(!e)return[];let t=[];return Object.keys(e).forEach(n=>{let o=e[n];n.includes("@refinedev")&&t.push({name:n,current:o.current,wanted:o.wanted,latest:o.latest})}),t.filter(n=>!!(0,Be.default)(n.current,n.latest))},cr=async()=>{let e="npm",{stdout:t,timedOut:r}=await(0,Ve.default)(e,X[e].outdatedJson,{reject:!1,timeout:25e3});if(r)throw new Error("Timed out while checking for updates.");return t?JSON.parse(t):null},Le=sr;var v=require("fs-extra"),re=p(require("temp")),Xe=require("pluralize"),Ye=p(require("execa")),Ke=p(require("inquirer")),ue=require("path");var K=(s=>(s.REACT_SCRIPT="react-scripts",s.REMIX="remix",s.NEXTJS="nextjs",s.VITE="vite",s.CRACO="craco",s))(K||{});var me=(o=>(o.ANTD="antd",o.MUI="mui",o.MANTINE="mantine",o.CHAKRA="chakra-ui",o))(me||{});var Me=(n=>(n.NPM="npm",n.YARN="yarn",n.PNPM="pnpm",n))(Me||{});var E=()=>{let e=q();if(e.includes("@craco/craco"))return"craco";if(e.includes("react-scripts"))return"react-scripts";if(e.includes("next"))return"nextjs";if(e.includes("@remix-run/react"))return"remix";if(be().includes("vite"))return"vite";throw new Error("Project type not found")},We=()=>{let e=q();if(e.includes("@refinedev/antd"))return"antd";if(e.includes("@refinedev/mui"))return"mui";if(e.includes("@refinedev/chakra-ui"))return"chakra-ui";if(e.includes("@refinedev/mantine"))return"mantine"};var $=p(require("handlebars")),O=require("fs-extra"),pr=(e,t)=>{let r=(0,O.readFileSync)(e);return $.default.registerHelper("ifIn",function(o,s,m){return o.includes(s)?m.fn($.default):m.inverse($.default)}),$.default.registerHelper("formatInferencerComponent",function(o){if(!!o)switch(o){case"chakra-ui":return"ChakraUI";default:return o.charAt(0).toUpperCase()+o.slice(1)}}),$.default.registerHelper("capitalize",function(o){if(!!o)return o.charAt(0).toUpperCase()+o.slice(1)}),$.default.compile(r.toString())(t)},He=(e,t)=>{(0,O.readdirSync)(e).forEach(n=>{let o=`${e}/${n}`,s=`${e}/${n.replace(".hbs","")}`;(0,O.createFileSync)(s),(0,O.writeFileSync)(s,pr(o,t)),(0,O.unlinkSync)(o)})};var Je=e=>e.charAt(0).toUpperCase()+e.slice(1);var le=e=>{switch(e){case"nextjs":return{path:"src/components",alias:"../src/components"};case"remix":return{path:"app/components",alias:"~/components"}}return{path:"src/pages",alias:"pages"}},qe=e=>{switch(e){case"remix":return"./app";case"nextjs":case"react-scripts":case"vite":case"craco":default:return"./src"}};var de=["list","create","edit","show"],mr=e=>{let t=E(),{path:r}=le(t);return e.command("create-resource").allowExcessArguments(!0).description("Create a new resource files").option("-a, --actions [actions]","Only generate the specified actions. (ex: list,create,edit,show)","list,create,edit,show").option("-p, --path [path]","Path to generate the resource files",r).action(lr)},lr=async(e,t)=>{let{args:r}=t,n=e.actions;if(!r.length){let{name:o,selectedActions:s}=await Ke.default.prompt([{type:"input",name:"name",message:"Resource Name",validate:m=>m?!0:"Resource Name is required"},{type:"checkbox",name:"selectedActions",message:"Select Actions",choices:de,default:e.actions.split(",")}]);r=[o],n=s.join(",")}r.forEach(o=>{let s=n?n.split(","):void 0,{path:m,alias:f}=le(E()),h=(0,Xe.plural)(o).toLowerCase(),a=(0,ue.join)(process.cwd(),m,h);if((0,v.pathExistsSync)(a)){console.error(`Resource (${(0,ue.join)(m,h)}) already exist! \u274C`);return}let l=Je(o),S=We(),z=`${__dirname}/../templates/resource`,N=dr();(0,v.copySync)(z,N);let i={resourceName:o,resource:l,actions:s||de,uiFramework:S};He(N,i),s&&de.forEach(k=>{s.includes(k)||(0,v.unlinkSync)(`${N}/${k}.tsx`)}),(0,v.mkdirSync)(e.path,{recursive:!0});let d=`${e.path}/${h}`,u={};(0,v.pathExistsSync)(d)&&(u={overwrite:!0}),(0,v.moveSync)(N,d,u),re.default.cleanupSync();let C=require.resolve(".bin/jscodeshift"),{stderr:x,stdout:y}=Ye.default.sync(C,["./","--extensions=ts,tsx,js,jsx","--parser=tsx",`--transform=${__dirname}/../src/transformers/resource.ts`,"--ignore-pattern=**/.cache/**","--ignore-pattern=**/node_modules/**","--ignore-pattern=**/build/**","--ignore-pattern=**/.next/**",`--__actions=${i.actions}`,`--__pathAlias=${f}`,`--__resourceFolderName=${h}`,`--__resource=${l}`,`--__resourceName=${o}`]);x&&console.log(x),console.log(`Resource (${d}) generated successfully! \u{1F389}`)})},dr=()=>(re.default.track(),re.default.mkdirSync("resource")),Ge=mr;var Ze=p(require("envinfo")),Qe=p(require("ora")),ur=e=>e.command("whoami").description("View the details of the development environment").action(fr),fr=async()=>{let e=(0,Qe.default)("Loading environment details...").start(),t=await Ze.default.run({System:["OS","CPU"],Binaries:["Node","Yarn","npm"],Browsers:["Chrome","Firefox","Safari"]},{showNotFound:!0,markdown:!0}),n=(await V()||[]).map(o=>` - ${o.name}: ${o.version}`).join(`
`);e.stop(),console.log(t),console.log("## Refine Packages:"),console.log(n)},et=ur;var ot=require("commander");var B=p(require("inquirer")),fe=p(require("semver-diff")),oe=p(require("chalk"));var tt=e=>{let t=e.filter((n,o)=>e.indexOf(n)!==o),r=new Set(t);return Array.from(r)};var rt=async e=>{let t=hr(e);if(!t){console.log("All `refine` packages are up to date. \u{1F389}");return}let r=xr(t),n=await B.default.prompt([{type:"checkbox",name:"packages",message:"Choose packages to update",pageSize:r.pageSize,choices:r.choices,validate:gr}]);return n.packages.length>0?n.packages:null},gr=e=>{let r=e.map(o=>De(o)).map(o=>o.name),n=tt(r);return n.length>0?`You can't update the same package more than once. Please choice one.
 Duplicates: ${n.join(", ")}`:!0},hr=e=>{if(e.length===0)return null;let t={patch:[],minor:[],major:[]};return e.forEach(r=>{let n=r.current,o=(0,fe.default)(n,r.wanted),s=(0,fe.default)(n,r.latest);if(o===s&&s){t[s].push({name:r.name,from:n,to:r.latest});return}o&&t[o].push({name:r.name,from:n,to:r.wanted}),s&&t[s].push({name:r.name,from:n,to:r.latest})}),t},xr=e=>{let t=0,r=0;[e.patch,e.minor,e.major].forEach(a=>{a.forEach(l=>{l.name.length>t&&(t=l.name.length),l.from.length>r&&(r=l.from.length)})}),t+=2;let n=[],o="Package".padEnd(t),s="From".padEnd(r),f=`
   ${o} ${s}${"To".padStart(r)}`;n.push(new B.default.Separator(f)),e.patch.length>0&&(n.push(new B.default.Separator(oe.default.reset.bold.blue(`
Patch Updates`))),e.patch.forEach(a=>{n.push({name:`${a.name.padEnd(t)} ${a.from.padStart(r)} -> ${a.to}`,value:`${a.name}@${a.to}`})})),e.minor.length>0&&(n.push(new B.default.Separator(oe.default.reset.bold.blue(`
Minor Updates`))),e.minor.forEach(a=>{n.push({name:`${a.name.padEnd(t)} ${a.from.padStart(r)} -> ${a.to}`,value:`${a.name}@${a.to}`})})),e.major.length>0&&(n.push(new B.default.Separator(oe.default.reset.bold.blue(`
Major Updates`))),e.major.forEach(a=>{n.push({name:`${a.name.padEnd(t)} ${a.from.padStart(r)} -> ${a.to}`,value:`${a.name}@${a.to}`})}));let h=n.length+6;return{choices:n,pageSize:h}};var wr=e=>e.command("update").description("Interactively select and update all `refine` packages to selected version. To skip the interactive mode, use the `--all` option.").addOption(new ot.Option("-t, --tag [tag]","Select version to update to.").choices(["next","latest"]).default("wanted","Version ranges in the `package.json` will be installed")).option("-a, --all","Update all `refine` packages to the selected `tag`. If `tag` is not provided, version ranges in the `package.json` will be installed. This option skips the interactive mode.",!1).option("-d, --dry-run","Get outdated packages installation command without automatic updating. If `tag` is not provided, version ranges in the `package.json` will be used.",!1).action(yr),yr=async e=>{let{tag:t,dryRun:r,all:n}=e,o=await F(Y,"Checking for updates...");if(!(o!=null&&o.length)){console.log("All `refine` packages are up to date \u{1F389}");return}let s=n?Tr(t,o):await rt(o);if(!!s){if(r){Cr(s);return}Er(s)}},Tr=(e,t)=>e==="wanted"&&t.every(o=>o.current===o.wanted)?(console.log("All `refine` packages are up to date with the wanted version \u{1F389}"),null):t.map(n=>{let o=e==="wanted"?n.wanted:e;return`${n.name}@${o}`}),Cr=async e=>{let t=await R(),r=X[t.name].install;console.log(`${t.name} ${r.join(" ")} ${e.join(" ")}`)},Er=e=>{console.log("Updating `refine` packages..."),console.log(e),_e(e)},nt=wr;var kt=p(require("react")),vt=require("ink"),xe=p(require("path")),U=p(require("chalk")),G=p(require("inquirer")),bt=p(require("inquirer-autocomplete-prompt")),D=require("fs-extra");var he=p(require("path"));var lt=p(require("path"));var ge={};Qt(ge,{PackageManagerTypes:()=>Me,ProjectTypes:()=>K,UIFrameworks:()=>me,appendAfterImports:()=>ct,getFileContent:()=>ne,getImports:()=>L,getNameChangeInImport:()=>it});var Pr=/import(?:(?:(?:[ \n\t]+([^ *\n\t\{\},]+)[ \n\t]*(?:,|[ \n\t]+))?([ \n\t]*\{(?:[ \n\t]*[^ \n\t"'\{\}]+[ \n\t]*,?)+\})?[ \n\t]*)|[ \n\t]*\*[ \n\t]*as[ \n\t]+([^ \n\t\{\}]+)[ \n\t]+)from[ \n\t]*(?:['"])([^'"\n]+)(?:['"])(?:;?)/g,Ir=/((?:\w|\s|_)*)( as )((?:\w|\s|_)*)( |,)?/g,L=e=>{let t=e.matchAll(Pr),r=[];for(let n of t){let[o,s,m,f,h]=n;r.push({statement:o,importPath:h,...s&&{defaultImport:s},...m&&{namedImports:m},...f&&{namespaceImport:f}})}return r==null?void 0:r.filter(Boolean)},it=e=>{let t=e.matchAll(Ir),r=[];for(let n of t){let[o,s,m,f,h]=n;r.push({statement:o,fromName:s.trim(),toName:f.trim(),afterCharacter:h})}return r},Sr=(e,t)=>{var s;let r=e.substring(0,e.indexOf(t.statement)),n=L(r).pop();return n?r.substring(r.indexOf(n==null?void 0:n.statement)+((s=n==null?void 0:n.statement)==null?void 0:s.length)):r},kr=(e,t)=>!!(t?Sr(e,t):"").trim(),st=["react","@refinedev/core","@refinedev/"],at=e=>{var N;let t=e,r=L(e),n=r.filter(i=>!i.statement.includes("import type ")),o=r.filter(i=>i.statement.includes("import type")),s=[],m=[];n.forEach(i=>{kr(e,i)?s.push(i):m.push(i)});let f=t.indexOf((N=m==null?void 0:m[0])==null?void 0:N.statement);m.forEach(i=>{t=t.replace(i.statement,"")}),o.forEach(i=>{t=t.replace(i.statement,"")});let h=m.reduce((i,d)=>{let{importPath:u}=d;return i[u]?i[u].push(d):i[u]=[d],i},{}),S=[...Object.entries(h).map(([i,d])=>{let u=d.find(k=>k.defaultImport),C=d.find(k=>k.namespaceImport),x=d.filter(k=>k.namedImports).map(k=>{var ie;return((ie=k.namedImports)!=null?ie:"").replace(/{|}/g,"").trim().split(",").map(Q=>Q.trim()).filter(Boolean).join(", ")}).join(", "),y="";return C&&(y+=C.statement+`
`),(u||x)&&(u&&x?y+=`import ${u.defaultImport}, { ${x} } from "${d[0].importPath}";
`:u?y+=`import ${u.defaultImport} from "${d[0].importPath}";
`:y+=`import { ${x} } from "${d[0].importPath}";
`),[i,y]})].sort(([i],[d])=>{let u=st.findIndex(x=>i.includes(x)),C=st.findIndex(x=>d.includes(x));return u===C?i.localeCompare(d):u===-1?1:C===-1?-1:u-C}).map(([,i])=>i).join(""),z=o.map(i=>i.statement).join(`
`);return t=t.substring(0,f)+S+z+t.substring(f),t};var ct=(e,t)=>{let r=L(e),n=r[r.length-1],o=n?e.indexOf(n.statement):e.length-1;return e.slice(0,o+(n==null?void 0:n.statement.length))+`
`+t+`
`+e.slice(o+(n==null?void 0:n.statement.length))};var pt=require("fs-extra"),mt=require("path");function ne(e){if(!!(this!=null&&this.absolutePackageDir))try{return(0,pt.readFileSync)((0,mt.join)(this.absolutePackageDir,e)).toString()}catch{return}}var dt=require("module"),vr=dt.prototype.require,ut=(e,t)=>{dt.prototype.require=function(...r){return r[0]==="@refinedev/cli"?{...ge,getFileContent:n=>ne.call({absolutePackageDir:t?e:lt.default.join(process.cwd(),e)},n)}:vr.apply(this,r)}};var ft=async(e,t)=>{try{return ut(e,t),require(he.default.join(t?e:he.default.join(process.cwd(),e),"refine.config.js"))}catch{return}};var se=require("prettier"),gt=async e=>{try{let t=await(0,se.resolveConfig)(process.cwd());return(0,se.format)(e,{...t!=null?t:{},parser:"typescript"})}catch{return e}};var g=p(require("react")),Tt=p(require("ink-markdown")),Ct=p(require("dedent")),w=require("ink");var I={SUCCESS:"SUCCESS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SOURCE_PATH_NOT_FOUND:"SOURCE_PATH_NOT_FOUND",TARGET_PATH_NOT_FOUND:"TARGET_PATH_NOT_FOUND",SOURCE_PATH_NOT_A_FILE:"SOURCE_PATH_NOT_A_FILE",TARGET_ALREADY_EXISTS:"TARGET_ALREADY_EXISTS"};var ht=p(require("chalk")),xt=p(require("cardinal")),wt=p(require("boxen")),br=e=>{var o;let t=/^(?:\/\/\s?title:\s?)(.*?)\n/g,[r,n]=(o=t.exec(e))!=null?o:[];if(n){let s=n.trim(),m=e.replace(r,"");return{title:s,code:m}}return{code:e}},yt=e=>{let{title:t,code:r}=br(e),n="";try{n=xt.default.highlight(r,{jsx:!0})}catch{n=r}return(0,wt.default)(n,{padding:1,margin:0,borderStyle:"round",borderColor:"gray",titleAlignment:"left",title:t?ht.default.bold(t):void 0})};var Nr=({label:e,files:t,message:r="**`Warning:`** You should use the component where you want to use it."})=>{let n=t.filter(([,a])=>Object.values(I).filter(l=>l!==I.SUCCESS).includes(a)),o="success";switch(n.length){case 0:o="success";break;case t.length:o="error";break;default:o="warning";break}let s=()=>{switch(o){case"success":return g.default.createElement(w.Text,{color:"blueBright"},"Successfully swizzled ",g.default.createElement(w.Text,{bold:!0},e));case"warning":return g.default.createElement(w.Text,{color:"yellowBright"},"Swizzle completed with errors for"," ",g.default.createElement(w.Text,{bold:!0},e));case"error":return g.default.createElement(w.Text,{color:"redBright"},"Swizzle failed for ",g.default.createElement(w.Text,{bold:!0},e))}return null},m=a=>{let l=a==null?void 0:a.replace(process.cwd(),"");return l!=null&&l.startsWith("/")?l.slice(1):l!=null&&l.startsWith("./")?l.slice(2):l},f=()=>g.default.createElement(g.default.Fragment,null,g.default.createElement(w.Text,{dimColor:!0},"File",t.length>1?"s":""," created:"),t.map(([a,l],S)=>l===I.SUCCESS?g.default.createElement(w.Text,{key:S,dimColor:!0,color:"cyanBright"},` - ${m(a)}`):l===I.TARGET_ALREADY_EXISTS?g.default.createElement(w.Text,{key:S,dimColor:!0,color:"cyanBright"}," - ",g.default.createElement(w.Text,{color:"yellowBright",bold:!0},"[FILE_ALREADY_EXISTS]"," "),`${m(a)}`):l===I.SOURCE_PATH_NOT_A_FILE?g.default.createElement(w.Text,{key:S,dimColor:!0,color:"cyanBright"}," - ",g.default.createElement(w.Text,{color:"yellowBright",bold:!0},"[SOURCE NOT FOUND]"," "),`${m(a)}`):g.default.createElement(w.Text,{key:S,dimColor:!0,color:"cyanBright"}," - ",g.default.createElement(w.Text,{color:"yellowBright",bold:!0},"[",l,"]")))),h=()=>r&&o!=="error"?g.default.createElement(g.default.Fragment,null,g.default.createElement(Tt.default,{code:yt},(0,Ct.default)(`
`+r)),g.default.createElement(w.Text,null,"\xA0")):null;return g.default.createElement(w.Box,{width:"100%",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start"},g.default.createElement(w.Text,null,"\xA0"),s(),f(),g.default.createElement(w.Text,null,"\xA0"),h())},Et=Nr;var Pt=e=>{let t=/(\/\/|\/\*)(\s?)swizzle-remove-start([\s\S]*?)(\/\/|\/\*)(\s?)swizzle-remove-end(\s*)(\*\/)?/g;return e.replace(t,"")};var Nt=p(require("boxen"));var It=()=>{let e;try{e=E()}catch{e=void 0}return qe(e)};var Or=e=>e.command("swizzle").description(`Export a component or a function from ${U.default.bold("refine")} packages to customize it in your project`).action(_r),St=e=>(t,r="")=>e.filter(o=>{var s;return o.label.toLowerCase().includes(r.toLowerCase())||((s=o.group)==null?void 0:s.toLowerCase().includes(r.toLowerCase()))}).flatMap((o,s,m)=>{var a;return[...(o==null?void 0:o.group)&&((a=m[s-1])==null?void 0:a.group)!==o.group&&o.group?[new G.default.Separator(`${U.default.bold(o.group)}`)]:[],{name:` ${o.label}`,value:o!=null&&o.value?o.value:o}]}),_r=async e=>{var l,S,z,N;G.default.registerPrompt("autocomplete",bt.default);let t=await Ne(),r=[];if(await Promise.all(t.map(async i=>{await Oe(i.path)&&r.push(i)})),r.length===0){console.log("No refine packages found with swizzle configuration.");return}console.log(`${(0,Nt.default)(`Found ${U.default.blueBright(r.length)} installed ${U.default.blueBright.bold("refine")} packages with swizzle configuration.`,{padding:1,textAlignment:"center",dimBorder:!0,borderColor:"blueBright",borderStyle:"round"})}
`);let n=await Promise.all(r.map(async i=>{var u;let d=(u=await ft(i.path))!=null?u:{swizzle:{items:[]}};return{...i,config:d}})),{selectedPackage:o}=await G.default.prompt([{type:"autocomplete",pageSize:10,name:"selectedPackage",message:"Which package do you want to swizzle?",emptyText:"No packages found.",source:St(n.sort((i,d)=>{var u,C,x,y;return((C=(u=i.config)==null?void 0:u.group)!=null?C:"").localeCompare((y=(x=d.config)==null?void 0:x.group)!=null?y:"")}).map(i=>{var d,u,C;return{label:(u=(d=i.config)==null?void 0:d.name)!=null?u:i.name,value:i,group:(C=i.config)==null?void 0:C.group}}))}]),{swizzle:{items:s,transform:m}}=o.config,f;if(s.length===0){console.log(`No swizzle items found for ${U.default.bold((S=(l=o.config)==null?void 0:l.name)!=null?S:o.name)}`);return}else s.length===1?f=s[0]:s.length>1&&(f=(await G.default.prompt([{type:"list",pageSize:10,name:"selectedComponent",message:"Which component do you want to swizzle?",emptyText:"No components found.",choices:St(s.sort((d,u)=>d.group.localeCompare(u.group)))({},"")}])).selectedComponent);if(!f){console.log(`No swizzle items selected for ${U.default.bold((N=(z=o.config)==null?void 0:z.name)!=null?N:o.name)}`);return}let h=It(),a=await Promise.all(f.files.map(async i=>{var d,u,C;try{let x=i.src?xe.default.join(o.path,i.src):void 0,y=i.dest?xe.default.join(process.cwd(),h,i.dest):void 0;if(!x)return console.log("No src path found for file",i),["",I.SOURCE_PATH_NOT_FOUND];if(!y)return console.log("No destination path found for file",i),["",I.TARGET_PATH_NOT_FOUND];if(!await(0,D.pathExists)(x))return[y,I.SOURCE_PATH_NOT_A_FILE];let Pe=await(0,D.readFile)(x,"utf-8");if(await(0,D.pathExists)(y))return[y,I.TARGET_ALREADY_EXISTS];await(0,D.ensureFile)(y);let Q=Pt(Pe),Ie=(u=(d=i.transform)==null?void 0:d.call(i,Q))!=null?u:Q,Ht=(C=m==null?void 0:m(Ie,x,y))!=null?C:Ie,Jt=at(Ht),qt=await gt(Jt);return await(0,D.writeFile)(y,qt),[y,I.SUCCESS]}catch{return["",I.UNKNOWN_ERROR]}}));a.length>0&&(0,vt.render)(kt.default.createElement(Et,{label:f.label,files:a,message:f.message}))},Ot=Or;var Z=`${process.cwd()}/node_modules/.bin`,b={["react-scripts"]:{dev:["start"],start:["start"],build:["build"],getBin:()=>`${Z}/react-scripts`},["vite"]:{dev:["start"],start:["preview"],build:["build"],getBin:()=>`${Z}/vite`},["nextjs"]:{dev:["dev"],start:["start"],build:["build"],getBin:()=>`${Z}/next`},["remix"]:{dev:["dev"],start:["build"],build:["build"],getBin:e=>`${Z}/${e==="start"?"remix-serve":"remix"}`},["craco"]:{dev:["start"],start:["start"],build:["build"],getBin:()=>`${Z}/craco`}};var _t=p(require("execa")),j=async(e,t)=>{var n,o;let r=(0,_t.default)(e,t,{stdio:"pipe",windowsHide:!1,env:{FORCE_COLOR:"true",...process.env}});return(n=r.stdout)==null||n.pipe(process.stdout),(o=r.stderr)==null||o.pipe(process.stderr),await r};var Rt=p(require("conf")),$t=p(require("chalk"));var Dt=p(require("dotenv"));Dt.config();var Dr={development:/dev/i,production:/prod/i,test:/test|tst/i,"continuous-integration":/ci/i,"user-acceptance-testing":/uat/i,"system-integration-testing":/sit/i},jr=()=>{let e=process.env.NODE_ENV;if(!e)return"development";let t="custom";for(let[r,n]of Object.entries(Dr))if(n.test(e)){t=r;break}return t},M={NODE_ENV:jr(),REFINE_NO_TELEMETRY:process.env.REFINE_NO_TELEMETRY||"false",UPDATE_NOTIFIER_IS_DISABLED:process.env.UPDATE_NOTIFIER_IS_DISABLED||"false",UPDATE_NOTIFIER_CACHE_TTL:process.env.UPDATE_NOTIFIER_CACHE_TTL||1e3*60*60*24};var jt=e=>typeof btoa<"u"?btoa(e):Buffer.from(e).toString("base64");var Ar="refine-update-notifier",A=new Rt.default({projectName:Ar,defaults:{key:"",lastUpdated:0,packages:[]}}),W=async()=>{if(Fr())return;let e=await $r();if(e!==null){if(e){At();return}Rr(),At()}},Rr=async()=>{let e=A.get("packages");!(e!=null&&e.length)||(await te(e),console.log(`
`))},$r=async()=>{let e=await zr(),t=Ur();return e===null?null:!!(t||!e)},At=async()=>{try{let e=await Y();return A.set("packages",e),A.set("lastUpdated",Date.now()),A.set("key",await Ut()),e}catch{return A.set("packages",[]),A.set("lastUpdated",Date.now()),A.set("key",""),null}},Ur=()=>{let e=A.get("lastUpdated");if(!e)return!0;let r=Date.now()-e,n=Number(M.UPDATE_NOTIFIER_CACHE_TTL);return r>=n},zr=async()=>{let e=A.get("key"),t=await Ut();return t===null?null:e===t},Ut=async()=>{let e=await V();if(!e)return console.error($t.default.red("Something went wrong when trying to get installed `refine` packages.")),null;let t=e.map(n=>`${n.name}@${n.version}`);return jt(t.toString())},Fr=()=>M.UPDATE_NOTIFIER_IS_DISABLED.toLocaleLowerCase()==="true";var H=e=>{let t=E(),r=b[t][e];return t==="remix"&&e==="start"&&(t="remix-serve"),`It runs: \`${t} ${r.join(" ")}\`. Also accepts all the arguments \`${t}\` accepts.`};var Vr=e=>e.command("start").description(H("start")).allowUnknownOption(!0).argument("[args...]").action(Br),Br=async e=>{let t=E(),r=b[t].getBin("start"),o=[...b[t].start,...e];await W(),j(r,o)},we=Vr;var Lr=e=>e.command("dev").description(H("dev")).allowUnknownOption(!0).argument("[args...]").action(Mr),Mr=async e=>{let t=E(),r=b[t].getBin("dev"),o=[...b[t].dev,...e];await W(),j(r,o)},ye=Lr;var Wr=e=>e.command("build").description(H("build")).allowUnknownOption(!0).argument("[args...]").action(Hr),Hr=async e=>{let t=E(),r=b[t].getBin("build"),o=[...b[t].build,...e];await W();try{await j(r,o)}catch{process.exit(1)}},Te=Wr;var Ce=p(require("chalk"));var Jr=e=>e.command("run").description("Runs a defined package script. If no `command` is provided, it will list the available scripts").allowUnknownOption(!0).argument("[command] [args...]").action(qr),qr=async e=>{let[t,...r]=e,n=ee();if(!t){console.log(`Available via ${Ce.default.blue("`refine run`")}:
`);for(let[m,f]of Object.entries(n))console.log(`  ${m}`),console.log(`    ${Ce.default.dim(f)}`),console.log();return}if(!Object.keys(n).includes(t)){let m=`${process.cwd()}/node_modules/.bin/${t}`;j(m,r);return}let s=await R();j(s.name,["run",t,...r])},Ee=Jr;var zt=p(require("envinfo")),Ft=p(require("os")),Xr=()=>{let e=Ft.default.type();return{Darwin:"macOS",Linux:"Linux",Windows_NT:"Windows"}[e]},Vt=async()=>{let[e,t]=await zt.default.helpers.getOSInfo();return{name:Xr(),version:t}};var Bt=p(require("node-fetch")),Yr=async()=>{let e=await Vt();return{nodeEnv:M.NODE_ENV,nodeVersion:process.version,os:e.name,osVersion:e.version,command:process.argv[2],packages:await V()||[],projectFramework:E()}},Lt=async()=>{if(M.REFINE_NO_TELEMETRY!=="true")try{let e=await Yr();await(0,Bt.default)("https://telemetry.refine.dev/cli",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}catch{}};var Kr=()=>{let e;try{e=J()}catch{console.error("The `package.json` file required to run could not be found."),process.exit(1)}let t=new Mt.Command;t.version(e.version,"-v, --version","Output the current version.").description(Wt.default.textSync("refine",{font:"Isometric1",horizontalLayout:"full",verticalLayout:"full",whitespaceBreak:!0})).usage("<command> [options]").helpOption("-h, --help","Output usage information."),Ot(t),Ge(t),nt(t),ye(t),Te(t),we(t),Ee(t),Le(t),et(t),t.hook("postAction",r=>{let n=r.args[0];["run"].includes(n)||Lt()}),t.parse(process.argv),process.argv.slice(2).length||t.outputHelp()};Kr();
//# sourceMappingURL=cli.js.map