var ne=Object.create;var g=Object.defineProperty;var ie=Object.getOwnPropertyDescriptor;var le=Object.getOwnPropertyNames;var de=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty;var me=(t,o)=>{for(var s in o)g(t,s,{get:o[s],enumerable:!0})},_=(t,o,s,p)=>{if(o&&typeof o=="object"||typeof o=="function")for(let a of le(o))!ue.call(t,a)&&a!==s&&g(t,a,{get:()=>o[a],enumerable:!(p=ie(o,a))||p.enumerable});return t};var ce=(t,o,s)=>(s=t!=null?ne(de(t)):{},_(o||!t||!t.__esModule?g(s,"default",{value:t,enumerable:!0}):s,t)),Te=t=>_(g({},"__esModule",{value:!0}),t);var pe={};me(pe,{useForm:()=>U,useModalForm:()=>q,useStepsForm:()=>I});module.exports=Te(pe);var w=require("react"),L=require("react-hook-form"),D=require("@refinedev/core"),U=({refineCoreProps:t,warnWhenUnsavedChanges:o,...s}={})=>{let{warnWhenUnsavedChanges:p,setWarnWhen:a}=(0,D.useWarnAboutChange)(),y=o!=null?o:p,f=(0,D.useForm)({...t}),{queryResult:n,onFinish:e,formLoading:S}=f,i=(0,L.useForm)({...s}),{watch:l,reset:x,getValues:V,handleSubmit:r}=i;(0,w.useEffect)(()=>{var d;if(typeof(n==null?void 0:n.data)<"u"){let b={},E=Object.keys(V());Object.entries(((d=n==null?void 0:n.data)==null?void 0:d.data)||{}).forEach(([C,m])=>{E.includes(C)&&(b[C]=m)}),x(b)}},[n==null?void 0:n.data]),(0,w.useEffect)(()=>{let d=l((b,{type:E})=>{E==="change"&&T(b)});return()=>d.unsubscribe()},[l]);let T=d=>(y&&a(!0),d),R=(d,b)=>async E=>(a(!1),await r(d,b)(E));return{...i,handleSubmit:R,refineCore:f,saveButtonProps:{disabled:S,onClick:d=>{R(e,()=>!1)(d)}}}};var v=require("react");var I=({stepsProps:t,...o}={})=>{let{defaultStep:s=0,isBackValidate:p=!1}=t!=null?t:{},[a,y]=(0,v.useState)(s),f=U({...o}),{trigger:n,getValues:e,reset:S,formState:{dirtyFields:i},refineCore:{queryResult:l}}=f;(0,v.useEffect)(()=>{var r;if(l!=null&&l.data){let T={},R=Object.keys(e());Object.entries((r=l==null?void 0:l.data)==null?void 0:r.data).forEach(([F,d])=>{R.includes(F)&&(i[F]?T[F]=e(F):T[F]=d)}),S(T,{keepDirty:!0,keepDirtyValues:!0})}},[l==null?void 0:l.data,a]);let x=r=>{let T=r;r<0&&(T=0),y(T)};return{...f,steps:{currentStep:a,gotoStep:async r=>{if(r===a)return;if(r<a&&!p){x(r);return}await n()&&x(r)}}}};var P=require("react"),u=require("@refinedev/core");var k=ce(require("react")),q=({modalProps:t,refineCoreProps:o,syncWithLocation:s,...p}={})=>{var K,O,A,Q,G,N,Y;let a=k.default.useRef(!1),y=(0,u.useTranslate)(),{resource:f,action:n}=o!=null?o:{},{resource:e,action:S}=(0,u.useResource)(f),i=(0,u.useParsed)(),l=(0,u.useGo)(),x=(K=n!=null?n:S)!=null?K:"",V=typeof s=="object"&&s.syncId,r=typeof s=="object"&&"key"in s?s.key:e&&x&&s?`modal-${(O=e==null?void 0:e.identifier)!=null?O:e==null?void 0:e.name}-${x}`:void 0,{defaultVisible:T=!1,autoSubmitClose:R=!0,autoResetForm:F=!0}=t!=null?t:{},d=U({refineCoreProps:o,...p}),{reset:b,refineCore:{onFinish:E,id:C,setId:m},saveButtonProps:ee,handleSubmit:te}=d,{visible:B,show:h,close:W}=(0,u.useModal)({defaultVisible:T});k.default.useEffect(()=>{var c,z,J,X;if(a.current===!1&&r){let H=(z=(c=i==null?void 0:i.params)==null?void 0:c[r])==null?void 0:z.open;if(typeof H=="boolean"?H&&h():typeof H=="string"&&H==="true"&&h(),V){let Z=(X=(J=i==null?void 0:i.params)==null?void 0:J[r])==null?void 0:X.id;Z&&(m==null||m(Z))}a.current=!0}},[r,i,V,m]),k.default.useEffect(()=>{var c;a.current===!0&&(B&&r?l({query:{[r]:{...(c=i==null?void 0:i.params)==null?void 0:c[r],open:!0,...V&&C&&{id:C}}},options:{keepQuery:!0},type:"replace"}):r&&!B&&l({query:{[r]:void 0},options:{keepQuery:!0},type:"replace"}))},[C,B,h,r,V]);let M=async c=>{await E(c),R&&W(),F&&b()},{warnWhen:$,setWarnWhen:re}=(0,u.useWarnAboutChange)(),oe=(0,P.useCallback)(()=>{if($)if(window.confirm(y("warnWhenUnsavedChanges","Are you sure you want to leave? You have unsaved changes.")))re(!1);else return;m==null||m(void 0),W()},[$]),se=(0,P.useCallback)(c=>{m==null||m(c),h()},[]),ae=y(`${e==null?void 0:e.name}.titles.${n}`,void 0,`${(0,u.userFriendlyResourceName)(`${n} ${(Y=(N=(G=(A=e==null?void 0:e.meta)==null?void 0:A.label)!=null?G:(Q=e==null?void 0:e.options)==null?void 0:Q.label)!=null?N:e==null?void 0:e.label)!=null?Y:e==null?void 0:e.name}`,"singular")}`);return{modal:{submit:M,close:oe,show:se,visible:B,title:ae},...d,saveButtonProps:{...ee,onClick:c=>te(M)(c)}}};
//# sourceMappingURL=index.js.map