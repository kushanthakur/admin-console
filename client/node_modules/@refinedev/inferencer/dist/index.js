var or=Object.create;var U=Object.defineProperty;var sr=Object.getOwnPropertyDescriptor;var ir=Object.getOwnPropertyNames;var ar=Object.getPrototypeOf,cr=Object.prototype.hasOwnProperty;var pr=(e,r)=>{for(var n in r)U(e,n,{get:r[n],enumerable:!0})},$e=(e,r,n,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of ir(r))!cr.call(e,o)&&o!==n&&U(e,o,{get:()=>r[o],enumerable:!(t=sr(r,o))||t.enumerable});return e};var h=(e,r,n)=>(n=e!=null?or(ar(e)):{},$e(r||!e||!e.__esModule?U(n,"default",{value:e,enumerable:!0}):n,e)),mr=e=>$e(U({},"__esModule",{value:!0}),e);var vr={};pr(vr,{accessor:()=>te,componentName:()=>z,createInferencer:()=>tr,dataProviderFromResource:()=>P,dotAccessor:()=>V,getAccessorKey:()=>ne,getFieldableKeys:()=>j,getOptionLabel:()=>ce,getVariableName:()=>me,isIDKey:()=>ae,jsx:()=>Q,noOp:()=>pe,prettyString:()=>L,printImports:()=>oe,removeRelationSuffix:()=>x,shouldDotAccess:()=>O,toPlural:()=>N,toSingular:()=>v});module.exports=mr(vr);var k=h(require("react")),ge=require("@refinedev/core");var lr=/(image|photo|avatar|url|logo|cover|thumbnail|icon)/i,j=(e,r)=>{let n=["name","label","title","count","content","username","nickname","login","firstName","lastName","url"];lr.test(e)&&n.unshift("url");let t=n.find(o=>o in r&&!!r[o]);if(t)return t==="firstName"&&"lastName"in r?["firstName","lastName"]:t};var we=require("@refinedev/core");function W(e,r,n){if(r)return r;let t=n==null?void 0:n.find(i=>i.name===e),o=(0,we.pickNotDeprecated)(t==null?void 0:t.meta,t==null?void 0:t.options);return o!=null&&o.dataProviderName?o.dataProviderName:"default"}var P=e=>{var r;return(r=e==null?void 0:e.options)==null?void 0:r.dataProviderName};var Z=e=>{let r=[...e].filter(Boolean).sort((n,t)=>(t.priority||0)-(n.priority||0))[0];return r||null};var fr=h(require("prettier/standalone")),ur=h(require("prettier/parser-typescript"));var M=e=>e.replace(/ {2,}/g," ").replace(/\n{2,}/g,`
`);var q=/(-id|-ids|_id|_ids|Id|Ids|ID|IDs)(\[\])?$/,Te=(e,r)=>{let n=q.test(e),t=typeof r=="string"||typeof r=="number",o=Array.isArray(r)&&r.every(i=>typeof i=="string"||typeof i=="number");return n&&t||n&&o?{key:e,relation:!0,multiple:!!o,type:"relation",priority:1}:!1};var x=e=>e.replace(q,"");var L=e=>x(e).replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/-/g," ").split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ");var Y=e=>e.replace(/export\s+(const|let|var|type|interface|function|class)\s+(\w+)\s*(=|:)\s*/g,"$1 $2 = ").split(`
`).filter(o=>!o.trim().startsWith("export default")).join(`
`);var ve=/import(?:(?:(?:[ \n\t]+([^ *\n\t\{\},]+)[ \n\t]*(?:,|[ \n\t]+))?([ \n\t]*\{(?:[ \n\t]*[^ \n\t"'\{\}]+[ \n\t]*,?)+\})?[ \n\t]*)|[ \n\t]*\*[ \n\t]*as[ \n\t]+([^ \n\t\{\}]+)[ \n\t]+)from[ \n\t]*(?:['"])([^'"\n]+)(?:['"])(?:;?)/g,dr=/import[ \n\t](?:['"])([^'"\n]+)(?:['"])(?:;?)/g,gr=/((?:\w|\s|_)*)( as )((?:\w|\s|_)*)( |,)?/g,G=(e,r={})=>{let n=e.matchAll(ve),t=new Set;for(let o of n){let[,i,a,m,p]=o;if(p in r){let l=r[p];if(p==="react")continue;i&&t.add(`const { default: ${i} } = ${l};`),a&&t.add(`const${a.replace(gr,"$1: $3$4")} = ${l};`),m&&t.add(`const ${m} = ${l};`)}}return M(`
    ${Array.from(t).join(`
`)}
    ${e.replace(ve,"").replace(dr,"")}
    `)};var _=h(require("pluralize"));var J=(e,r)=>e?r.find(t=>{let o=x(e.key);return t.name===o||t.name===(_.default.isPlural(o)?o:_.default.plural(o))||t.name===(_.default.isSingular(o)?o:_.default.singular(o))}):void 0;var Ne=h(require("pluralize"));var z=(e,r,n="Inferred")=>{let t=e.replace(/[^a-zA-Z0-9]/g," "),o=Ne.default.singular(t),a=L(o).replace(/ /g,"")||n,m=r.charAt(0).toUpperCase()+r.slice(1);return/^[a-zA-Z]/.test(a)?`${a}${m}`:`${m}${a}`};var yr=e=>e?Array.isArray(e)?e.join(""):typeof e=="string"?e:typeof e=="object"||typeof e=="function"?e.toString():typeof e=="number"?String(e):typeof e=="boolean"&&e?"true":e:"",Q=(e,...r)=>e.reduce((t,o,i)=>`${t}${o}${yr(r[i])}`,"").trim();var X=(e,r)=>`
    ${e!=null?e:""}
    
    render(typeof ${r} !== "undefined" ? <${r} /> : <></>);
    `;var ee=e=>e==null?void 0:e.replace(/(\/\* hidden-start \*\/)(.|\n)*?(\/\* hidden-end \*\/)/g,"");var Ir=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/,O=e=>Ir.test(e);function re(e,r,n){let t=`${e}`;return r&&(t+="?.",O(r)?t+=r:t+=`['${r}']`),n&&(t+="?.",O(n)?t+=n:t+=`['${n}']`),t}function hr(e,r,n){return(n!=null?n:[]).map(o=>re(e,r,o))}var te=(e,r,n,t=' + " " + ')=>Array.isArray(n)?t?hr(e,r,n).join(t):re(e,r,n[0]):re(e,r,n),V=(e,r,n)=>{let t=e;return r&&(t+=`.${r}`),n&&(Array.isArray(n)?t+=`.${n[0]}`:t+=`.${n}`),t},ne=e=>Array.isArray(e.accessor)||e.multiple?`accessorKey: "${e.key}"`:e.accessor?`accessorKey: "${V(e.key,void 0,e.accessor)}"`:`accessorKey: "${e.key}"`;var oe=e=>{let r=e.reduce((t,[o,i,a])=>(t[i]||(t[i]=[]),t[i].includes(o)||(a?t[i].push([o,!0]):t[i].push(o)),t),{});return Object.entries(r).map(([t,o])=>{let i=o.find(l=>Array.isArray(l)&&l[1]),a=o.filter(l=>typeof l=="string"),m=i?`${i[0]}`:"",p=a.length?`{ ${a.join(", ")} }`:"";return`import ${m}${m&&p?", ":""}${p} from "${t}";`})};var se=h(require("pluralize")),v=(e="")=>se.default.isSingular(e)?e:se.default.singular(e);var ie=h(require("pluralize")),N=(e="")=>ie.default.isPlural(e)?e:ie.default.plural(e);var xr=/^id$/i,ae=e=>xr.test(e);var ce=e=>e.relationInfer&&e.relationInfer.accessor?Array.isArray(e.relationInfer.accessor)?`optionLabel: "${e.relationInfer.accessor[0]}",`:e.relationInfer.accessor!=="title"?`optionLabel: "${e.relationInfer.accessor}",`:"":"";var pe=e=>{};var me=(e,r="")=>{if(Number.isInteger(Number(e)))return r.charAt(0).toLowerCase()+r.slice(1)+e;let t=e.replace(/^\d+/,"").replace(/[^a-zA-Z0-9]/g,"-"),o=L(t).replace(/ /g,"");return`${o.charAt(0).toLowerCase()+o.slice(1)}${r.charAt(0).toUpperCase()+r.slice(1)}`};var Se=e=>{let r=(n,t,o,i=r)=>{let a=e.map(p=>p(n,t,o,i));return Z(a)};return r};var Pe=e=>(n,t,o,i,a)=>e.reduce((m,p)=>p(m,t,o,i,a),n);var Le=(e,r,n,t)=>{let o=Array.isArray(r),i=Array.isArray(r)&&r.every(a=>typeof a=="string"||typeof a=="number");if(o){if(!i){let m=t(e,r[0],n,t);return m?{...m,key:e,multiple:!0,priority:1}:!1}let a=t(e,r[0],n,t)||{type:"string"};return{key:e,multiple:!0,priority:1,type:a==null?void 0:a.type}}return!1};var De=(e,r)=>typeof r=="boolean"?{key:e,type:"boolean"}:!1;var le=h(require("dayjs")),br=/(_at|_on|At|On|AT|ON)(\[\])?$/,Fr=["/",":","-","."],Ke=(e,r)=>{let n=br.test(e)&&(0,le.default)(r).isValid(),t=typeof r=="string"&&(0,le.default)(r).isValid();return typeof r=="string"&&Fr.some(i=>r.includes(i))&&(n||t)?{key:e,type:"date",priority:1}:!1};var Ar=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,Ee=(e,r)=>typeof r=="string"&&Ar.test(r)?{key:e,type:"email",priority:1}:!1;var kr=/\.(gif|jpe?g|tiff?|png|webp|bmp|svg)$/i,je=(e,r)=>typeof r=="string"&&kr.test(r)?{key:e,type:"image",priority:2}:!1;var _e=(e,r)=>typeof r>"u"||r===null?null:!1;var ze=(e,r)=>{let n=typeof r=="string"&&r.length>0,t=!isNaN(r);return n&&t||typeof r=="number"?{key:e,type:"number"}:!1};var Cr=/id$/i,Oe=(e,r,n,t)=>{let o=r!==null,i=!Array.isArray(r);if(o&&i&&typeof r=="object"){if(Object.keys(r).length===1&&Cr.test(Object.keys(r)[0]))return{key:e,type:"relation",relation:!0,accessor:"id",priority:1};let p=j(e,r);if((p?p.length>0:!1)&&p){let y=p&&Array.isArray(p)?p[0]:p,u=t(y,r[y],r,t);if(u){let f=Array.isArray(p)?p.map(d=>u.accessor?`${d}.${Array.isArray(u.accessor)?u.accessor[0]:u.accessor}`:d):u.accessor?Array.isArray(u.accessor)?`${p}.${u.accessor[0]}`:`${p}.${u.accessor}`:p;return{...u,fieldable:!0,key:e,accessor:f,priority:1}}}return{key:e,fieldable:!1,type:"object",priority:1}}return!1};var Ue=(e,r)=>typeof r=="string"&&r.length>100?{key:e,type:"richtext",priority:1}:!1;var Ve=(e,r)=>typeof r=="string"?{key:e,type:"text"}:!1;var Rr=/^(https?|ftp):\/\/(-\.)?([^\s/?\.#-]+\.?)+(\/[^\s]*)?$/i,Be=(e,r)=>typeof r=="string"&&Rr.test(r)?{key:e,type:"url",priority:1}:!1;var He=[Le,De,Ke,Ee,je,_e,ze,Oe,Te,Ue,Ve,Be];var We=(e,r,n,t)=>e.map(i=>{if(!i.relation&&(i.type==="text"||i.type==="richtext"||i.type==="number")&&!i.canRelation){let a=/^[a-z0-9-]+$/,m=f=>a.test(`${f}`),p=i.key.toLowerCase()!=="id";return!(!i.accessor||typeof i.accessor=="string")||!p?i:(i.multiple?t[i.key]:[t[i.key]]).every(f=>m(i.accessor?f[i.accessor]:f))?{...i,canRelation:!0}:i}return i});var $r=/(image|photo|avatar|cover|thumbnail|icon)/i,Ze=e=>e.map(n=>n.type==="url"&&$r.test(n.key)?{...n,type:"image"}:n);var Me=(e,r)=>e.map(t=>{let o=J(t,r);return o?{...t,relation:!0,type:"relation",resource:o}:t});var qe=(e,r,n,t,o)=>e.map(a=>{if(a.relation&&a.type==="relation"&&!a.resource){let m=a.accessor?t[a.key][a.accessor]:t[a.key],p=o(a.key,m,t,o);if(p&&p.type!=="relation")return{...a,fieldable:!0,relation:!1,type:p.type,canRelation:!0}}return a});var Ye=[Ze,Me,qe,We];var Ge=h(require("react")),Je=h(require("prism-react-renderer")),wr=h(require("prism-react-renderer/themes/vsDark"));var b=h(require("react")),Tr=h(require("@refinedev/core")),B=require("@aliemir/react-live");var Qe=[["react","React",b.default],["@refinedev/core","RefineCore",Tr]],fe=b.default.createContext({}),ue=({fetchError:e,code:r,additionalScope:n,errorComponent:t})=>{var m;let o=(m=r&&Y(G(r,[...Qe,...n!=null?n:[]].reduce((p,[l,y,u,f])=>f?p:{...p,[l]:y},{}))))!=null?m:"",i=b.default.useMemo(()=>({React:b.default,...b.default,...[...Qe,...n!=null?n:[]].reduce((p,[l,y,u])=>({...p,[y]:u}),{})}),[n]),a=b.default.useMemo(()=>()=>{let{error:l}=b.default.useContext(fe);return t?b.default.createElement(t,{error:l?`<p>An error occured while rendering the generated component.You can check the generated code from the below "Show Code" button and fix the error manually.</p>
                                    <p>If you think this is a bug, please report the issue at <a target="_blank" rel="noopener noreferrer" href="https://github.com/refinedev/refine/issues">https://github.com/refinedev/refine/issues</a></p>
                                    <p>Exception:</p>
                                    <code>${l}</code>`:typeof e=="string"?e:e?`<p>Something went wrong while fetching the resource data.</p>
                                    <p>To learn more about the Inferencer, please check the <a href="https://refine.dev/docs/packages/documentation/inferencer/" target="_blank">documentation</a>.</p>`:void 0}):null},[t,e]);return b.default.createElement(B.LiveProvider,{Context:fe,code:o,scope:i,noInline:!0},!e&&b.default.createElement(B.LivePreview,{Context:fe}),b.default.createElement(a,null))};var D=h(require("react")),H=require("@refinedev/core");var Xe=(e,r,n)=>{let{resource:t,id:o,resources:i}=(0,H.useResource)(r),a=n!=null?n:o,m=(0,H.useDataProvider)(),[p,l]=D.default.useState(void 0),[y,u]=D.default.useState(void 0),[f,d]=D.default.useState(!0),[R,s]=D.default.useState(!1),$=D.default.useCallback(async C=>{var F,S;let I=(F=P(t))!=null?F:W(t==null?void 0:t.name,void 0,i),g=m(I);s(!0),l(void 0);try{if((e==="list"||e==="create")&&t){let A=(S=(await g.getList({resource:t==null?void 0:t.name})).data)==null?void 0:S[0];A||l(`<p>No records/data found for resource "${t==null?void 0:t.name}".</p>
                            <p>Please check your data provider and resource.</p>
                            <p>For more info, please check the <a href="https://refine.dev/docs/packages/documentation/inferencer/" target="_blank">documentation</a>.</p>`),u(A),setTimeout(()=>{s(!1)},500)}if((e==="edit"||e==="show")&&C&&t){let A=(await g.getOne({resource:t==null?void 0:t.name,id:C})).data;A||l(`<p>No records/data found for resource "${t==null?void 0:t.name}".</p>
                            <p>Please check your data provider and resource.</p>
                            <p>For more info, please check the <a href="https://refine.dev/docs/packages/documentation/inferencer/" target="_blank">documentation</a>.</p>`),u(A),setTimeout(()=>{s(!1)},500)}}catch(w){console.warn("An error occured while fetching the resource data. Please check the error message below:",w),l(`<p>Something went wrong while fetching the resource data.</p>
                    <p>Please check your data provider and API for resource "${t==null?void 0:t.name}".</p>
                    <p>For more info, please check the <a href="https://refine.dev/docs/packages/documentation/inferencer/" target="_blank">documentation</a>.</p>`),setTimeout(()=>{s(!1)},500)}},[e,m,t,i]);return D.default.useEffect(()=>{d(!1),!R&&!y&&$(a)},[$,a]),{data:y,loading:R,initial:f,error:p}};var K=h(require("react")),er=require("@refinedev/core");var de=require("lodash"),rr=({record:e,fields:r,infer:n})=>{let t=(0,er.useDataProvider)(),[o,i]=K.default.useState([]),[a,m]=K.default.useState(!0),[p,l]=K.default.useState(!1),y=K.default.useCallback(async u=>{console.groupCollapsed("@refinedev/inferencer is trying to detect relations");let f=[];l(!0);try{let d=u.map(async s=>{if(s&&(s.relation||s.canRelation)&&e){let $=P(s.resource),C=t($),I=Array.isArray(s.accessor)?void 0:s.multiple?e[s.key].map(g=>s.accessor?(0,de.get)(g,s.accessor):g)[0]:s.accessor?(0,de.get)(e[s.key],s.accessor):e[s.key];if(I&&s.resource)try{let{data:g}=await C.getOne({resource:s.resource.name,id:I});f.push({status:"success",resource:s.resource.name,field:s.key});let F=n("__",g,{},n);return{...s,relationInfer:F}}catch{return f.push({status:"error",resource:s.resource.name,field:s.key}),{...s,relationInfer:null}}if(I){let g,F;try{let{data:A}=await C.getOne({resource:N(x(s.key)),id:I});f.push({status:"success",resource:N(x(s.key)),field:s.key}),g=A,F=!0}catch{f.push({status:"error",resource:N(x(s.key)),field:s.key});try{let{data:T}=await C.getOne({resource:v(x(s.key)),id:I});f.push({status:"success",resource:v(x(s.key)),field:s.key}),g=T,F=!1}catch{return f.push({status:"error",resource:v(x(s.key)),field:s.key}),{...s,relationInfer:null}}}let S=n("__",g,{},n),w=x(s.key);return{...s,relation:!0,type:"relation",resource:{name:F?N(w):v(w)},fieldable:!1,canRelation:void 0,relationInfer:S}}return{...s,relationInfer:null}}return s}),R=await Promise.all(d);i(R.filter(s=>s)),setTimeout(()=>{l(!1)},500)}catch{setTimeout(()=>{l(!1)},500)}setTimeout(()=>{console.log(`Tried to detect relations with ${f.length} attempts and succeeded with ${f.filter(d=>d.status==="success").length} attempts.`),console.groupEnd()},500)},[t,e]);return K.default.useEffect(()=>{m(!1),!p&&r&&r.length>0&&o.length===0&&y(r)},[y,p,r,y]),{fields:o,loading:p,initial:a}};var tr=({type:e,additionalScope:r=[],customElements:n=[],fieldTransformers:t=[],renderer:o,loadingComponent:i,errorComponent:a,codeViewerComponent:m})=>{let p=Se([...He,...n]),l=Pe([...Ye,...t]),y=({resourceName:f,fieldTransformer:d,id:R})=>{var Ie,he,xe,be,Fe,Ae;let{resource:s,resources:$}=(0,ge.useResource)(f),{resource:C}=(0,ge.useResource)(),{data:I,loading:g,initial:F,error:S}=Xe(e,f!=null?f:s==null?void 0:s.name,R),w=k.default.useMemo(()=>{if(I){let nr=Object.keys(I).map(E=>{let ke=I[E];return p(E,ke,I,p)}).filter(Boolean);if(s){let E=l(nr,$,s,I,p);return d?E.flatMap(Ce=>{let Re=d(Ce);return Re?[Re]:[]}):E}return[]}return[]},[I,$,s,d]),{fields:A,loading:T}=rr({record:I,fields:w,infer:p}),ye=k.default.useMemo(()=>!g&&!T&&!F&&s?o({resource:s,resources:$,fields:A,infer:p,isCustomPage:s.name!==(C==null?void 0:C.name),id:R}):"",[s,$,A,g,T]);return k.default.createElement(k.default.Fragment,null,i&&(g||T)&&k.default.createElement(i,null),!g&&!T&&k.default.createElement(k.default.Fragment,null,k.default.createElement(ue,{fetchError:!g&&S?S:!g&&!F&&!I,code:X(ye,z((Ae=(Fe=(be=(xe=(Ie=s==null?void 0:s.meta)==null?void 0:Ie.label)!=null?xe:(he=s==null?void 0:s.options)==null?void 0:he.label)!=null?be:s==null?void 0:s.label)!=null?Fe:s==null?void 0:s.name)!=null?Ae:"Resource",e)),errorComponent:a,additionalScope:r}),m&&k.default.createElement(m,{code:ee(ye),loading:g||T})))};return({name:f,resource:d,fieldTransformer:R,id:s})=>k.default.createElement(y,{fieldTransformer:R,resourceName:d!=null?d:f,key:d!=null?d:f,id:s})};
//# sourceMappingURL=index.js.map