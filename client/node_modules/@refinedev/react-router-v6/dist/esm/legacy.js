import{handleUseParams as te}from"@refinedev/core";import{useLocation as F,useParams as ne,Link as se,useNavigate as ue}from"react-router-dom";import w from"react";import{BrowserRouter as Y,MemoryRouter as Z,HashRouter as A}from"react-router-dom";import o,{useMemo as K}from"react";import{Route as p,Routes as U,Navigate as $,Outlet as _}from"react-router-dom";import{LoginPage as q,ErrorComponent as f,LayoutWrapper as G,useResource as j,useRefineContext as H,useRouterContext as J,CanAccess as R,useActiveAuthProvider as Q,useIsAuthenticated as T}from"@refinedev/core";var B=({route:r})=>{var v,E,c,L;let{catchAll:e}=H(),{useParams:n}=J(),{resources:d}=j(),{action:m,id:i}=n(),t=d.find(P=>P.route===r);if(t){let{list:P,create:C,edit:h,show:y,name:l,canCreate:s,canEdit:a,canShow:u,canDelete:g,options:x}=t,k=()=>console.error("`string` resource routes are not supported in legacy router. Please switch to the new router or assign Components to the resource routes."),S=()=>console.error("`Object` resource routes are not supported in legacy router. Please switch to the new router or assign Components to the resource routes."),N=(v=typeof P=="string"?k():typeof P=="object"?S():P)!=null?v:()=>null,O=(E=typeof C=="string"?k():typeof C=="object"?S():C)!=null?E:()=>null,z=(c=typeof h=="string"?k():typeof h=="object"?S():h)!=null?c:()=>null,V=(L=typeof y=="string"?k():typeof y=="object"?S():y)!=null?L:()=>null;return(()=>{switch(m){case void 0:return o.createElement(R,{resource:l,action:"list",fallback:e!=null?e:o.createElement(f,null),params:{resource:t}},P?o.createElement(N,{name:l,canCreate:s,canEdit:a,canDelete:g,canShow:u,options:x}):e!=null?e:o.createElement(f,null));case"create":case"clone":return o.createElement(R,{resource:l,action:"create",fallback:e!=null?e:o.createElement(f,null),params:{id:i?decodeURIComponent(i):void 0,resource:t}},C?o.createElement(O,{name:l,canCreate:s,canEdit:a,canDelete:g,canShow:u,options:x}):e!=null?e:o.createElement(f,null));case"edit":return o.createElement(R,{resource:l,action:"edit",params:{id:i?decodeURIComponent(i):void 0,resource:t},fallback:e!=null?e:o.createElement(f,null)},h?o.createElement(z,{name:l,canCreate:s,canEdit:a,canDelete:g,canShow:u,options:x}):e!=null?e:o.createElement(f,null));case"show":return o.createElement(R,{resource:l,action:"show",params:{id:i?decodeURIComponent(i):void 0,resource:t},fallback:e!=null?e:o.createElement(f,null)},y?o.createElement(V,{name:l,canCreate:s,canEdit:a,canDelete:g,canShow:u,options:x}):e!=null?e:o.createElement(f,null));default:return o.createElement(o.Fragment,null,e!=null?e:o.createElement(f,null))}})()}return o.createElement(o.Fragment,null,e!=null?e:o.createElement(f,null))},I=({initialRoute:r})=>{let{resources:e}=j(),{catchAll:n,DashboardPage:d,LoginPage:m}=H(),{routes:i}=J(),t=Q(),{isFetching:v,isError:E,data:c}=T({v3LegacyAuthProviderCompatible:Boolean(t==null?void 0:t.isLegacy),params:{type:"routeProvider"}}),L=K(()=>t!=null&&t.isProvided?t!=null&&t.isLegacy?!(E||(c==null?void 0:c.error)):c==null?void 0:c.authenticated:!0,[c,E,t==null?void 0:t.isLegacy]);if(v)return o.createElement(U,null,o.createElement(p,{path:"*",element:null}));let P=()=>{let{pathname:s,search:a}=location,u=`${s}${a}`;return o.createElement($,{to:`/login?to=${encodeURIComponent(u)}`})},C=[];e.map(s=>{let a=o.createElement(p,{key:`${s.route}`,path:`${s.route}`,element:o.createElement(B,{route:s.route})},o.createElement(p,{path:":action",element:o.createElement(B,{route:s.route})},o.createElement(p,{path:":id",element:o.createElement(B,{route:s.route})})));C.push(a)});let h=()=>{var s,a;return o.createElement(U,null,[...i||[]].filter(u=>!u.layout).map((u,g)=>o.createElement(p,{key:`custom-route-${g}`,...u,element:u.element})),o.createElement(p,{path:"/",element:o.createElement(G,null,o.createElement(_,null))},[...i||[]].filter(u=>u.layout).map((u,g)=>o.createElement(p,{key:`custom-route-${g}`,...u,element:u.element})),d?o.createElement(p,{index:!0,element:o.createElement(R,{resource:"dashboard",action:"list",fallback:n!=null?n:o.createElement(f,null)},o.createElement(d,null))}):o.createElement(p,{index:!0,element:o.createElement($,{to:r!=null?r:`/${(a=(s=e.find(u=>u.list))==null?void 0:s.route)==null?void 0:a.replace(/^\//,"")}`})}),...[...C||[]],o.createElement(p,{path:"*",element:o.createElement(B,{route:""})})))},y=()=>m?o.createElement(m,null):o.createElement(q,null);return L?h():(()=>o.createElement(U,null,[...i||[]].map((s,a)=>o.createElement(p,{key:`custom-route-${a}`,...s})),o.createElement(p,{path:"/",element:y()}),o.createElement(p,{path:"/login",element:y()}),o.createElement(p,{path:"*",element:o.createElement(P,null)})))()};function M({children:r,...e}){return w.createElement(Y,{...e},w.createElement(I,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}function W({children:r,...e}){return w.createElement(Z,{...e},w.createElement(I,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}function ee({children:r,...e}){return w.createElement(A,{...e},w.createElement(I,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}import b from"react";import{UNSAFE_NavigationContext as oe}from"react-router-dom";function re(r,e=!0){let{navigator:n}=b.useContext(oe);b.useEffect(()=>{if(!e)return;let d=n.go,m=n.push;return n.push=(...i)=>{r()!==!1&&m(...i)},n.go=(...i)=>{r()!==!1&&d(...i)},()=>{n.push=m,n.go=d}},[n,r,e])}function X(r,e=!0,n,d=!1){let m=b.useCallback(t=>(t.preventDefault(),t.returnValue=r,t.returnValue),[r]);b.useEffect(()=>(e&&!d&&window.addEventListener("beforeunload",m),()=>{window.removeEventListener("beforeunload",m)}),[m,e,d]);let i=b.useCallback(()=>{let t=window.confirm(r);return t&&n&&n(),t},[r]);re(i,e)}var D=({message:r,when:e,setWarnWhen:n})=>(X(r,e,()=>{n==null||n(!1)},!0),null);var ie={useHistory:()=>{let r=ue();return{push:r,replace:e=>{r(e,{replace:!0})},goBack:()=>{r(-1)}}},useLocation:F,useParams:()=>{let r=ne(),{pathname:e}=F(),n=`/${Object.values(r).join("/")}`;return te({...r,resource:Object.keys(r).length===0?e.substring(1):decodeURIComponent(e.substring(1)).replace(n,"")})},Prompt:D,Link:se,RouterComponent:M},je=ie;export{M as BrowserRouterComponent,ee as HashRouterComponent,W as MemoryRouterComponent,je as default};
//# sourceMappingURL=legacy.js.map