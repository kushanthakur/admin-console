var G=Object.create;var I=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty;var A=(r,e)=>{for(var n in e)I(r,n,{get:e[n],enumerable:!0})},M=(r,e,n,f)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of T(e))!Z.call(r,a)&&a!==n&&I(r,a,{get:()=>e[a],enumerable:!(f=Q(e,a))||f.enumerable});return r};var H=(r,e,n)=>(n=r!=null?G(Y(r)):{},M(e||!r||!r.__esModule?I(n,"default",{value:r,enumerable:!0}):n,r)),W=r=>M(I({},"__esModule",{value:!0}),r);var te={};A(te,{BrowserRouterComponent:()=>J,HashRouterComponent:()=>D,MemoryRouterComponent:()=>X,default:()=>re});module.exports=W(te);var z=require("@refinedev/core"),P=require("react-router-dom");var w=H(require("react")),R=require("react-router-dom");var o=H(require("react")),u=require("react-router-dom"),t=require("@refinedev/core"),U=({route:r})=>{var L,v,c,x;let{catchAll:e}=(0,t.useRefineContext)(),{useParams:n}=(0,t.useRouterContext)(),{resources:f}=(0,t.useResource)(),{action:a,id:m}=n(),s=f.find(g=>g.route===r);if(s){let{list:g,create:y,edit:E,show:h,name:l,canCreate:i,canEdit:d,canShow:p,canDelete:C,options:k}=s,S=()=>console.error("`string` resource routes are not supported in legacy router. Please switch to the new router or assign Components to the resource routes."),B=()=>console.error("`Object` resource routes are not supported in legacy router. Please switch to the new router or assign Components to the resource routes."),V=(L=typeof g=="string"?S():typeof g=="object"?B():g)!=null?L:()=>null,K=(v=typeof y=="string"?S():typeof y=="object"?B():y)!=null?v:()=>null,_=(c=typeof E=="string"?S():typeof E=="object"?B():E)!=null?c:()=>null,q=(x=typeof h=="string"?S():typeof h=="object"?B():h)!=null?x:()=>null;return(()=>{switch(a){case void 0:return o.default.createElement(t.CanAccess,{resource:l,action:"list",fallback:e!=null?e:o.default.createElement(t.ErrorComponent,null),params:{resource:s}},g?o.default.createElement(V,{name:l,canCreate:i,canEdit:d,canDelete:C,canShow:p,options:k}):e!=null?e:o.default.createElement(t.ErrorComponent,null));case"create":case"clone":return o.default.createElement(t.CanAccess,{resource:l,action:"create",fallback:e!=null?e:o.default.createElement(t.ErrorComponent,null),params:{id:m?decodeURIComponent(m):void 0,resource:s}},y?o.default.createElement(K,{name:l,canCreate:i,canEdit:d,canDelete:C,canShow:p,options:k}):e!=null?e:o.default.createElement(t.ErrorComponent,null));case"edit":return o.default.createElement(t.CanAccess,{resource:l,action:"edit",params:{id:m?decodeURIComponent(m):void 0,resource:s},fallback:e!=null?e:o.default.createElement(t.ErrorComponent,null)},E?o.default.createElement(_,{name:l,canCreate:i,canEdit:d,canDelete:C,canShow:p,options:k}):e!=null?e:o.default.createElement(t.ErrorComponent,null));case"show":return o.default.createElement(t.CanAccess,{resource:l,action:"show",params:{id:m?decodeURIComponent(m):void 0,resource:s},fallback:e!=null?e:o.default.createElement(t.ErrorComponent,null)},h?o.default.createElement(q,{name:l,canCreate:i,canEdit:d,canDelete:C,canShow:p,options:k}):e!=null?e:o.default.createElement(t.ErrorComponent,null));default:return o.default.createElement(o.default.Fragment,null,e!=null?e:o.default.createElement(t.ErrorComponent,null))}})()}return o.default.createElement(o.default.Fragment,null,e!=null?e:o.default.createElement(t.ErrorComponent,null))},j=({initialRoute:r})=>{let{resources:e}=(0,t.useResource)(),{catchAll:n,DashboardPage:f,LoginPage:a}=(0,t.useRefineContext)(),{routes:m}=(0,t.useRouterContext)(),s=(0,t.useActiveAuthProvider)(),{isFetching:L,isError:v,data:c}=(0,t.useIsAuthenticated)({v3LegacyAuthProviderCompatible:Boolean(s==null?void 0:s.isLegacy),params:{type:"routeProvider"}}),x=(0,o.useMemo)(()=>s!=null&&s.isProvided?s!=null&&s.isLegacy?!(v||(c==null?void 0:c.error)):c==null?void 0:c.authenticated:!0,[c,v,s==null?void 0:s.isLegacy]);if(L)return o.default.createElement(u.Routes,null,o.default.createElement(u.Route,{path:"*",element:null}));let g=()=>{let{pathname:i,search:d}=location,p=`${i}${d}`;return o.default.createElement(u.Navigate,{to:`/login?to=${encodeURIComponent(p)}`})},y=[];e.map(i=>{let d=o.default.createElement(u.Route,{key:`${i.route}`,path:`${i.route}`,element:o.default.createElement(U,{route:i.route})},o.default.createElement(u.Route,{path:":action",element:o.default.createElement(U,{route:i.route})},o.default.createElement(u.Route,{path:":id",element:o.default.createElement(U,{route:i.route})})));y.push(d)});let E=()=>{var i,d;return o.default.createElement(u.Routes,null,[...m||[]].filter(p=>!p.layout).map((p,C)=>o.default.createElement(u.Route,{key:`custom-route-${C}`,...p,element:p.element})),o.default.createElement(u.Route,{path:"/",element:o.default.createElement(t.LayoutWrapper,null,o.default.createElement(u.Outlet,null))},[...m||[]].filter(p=>p.layout).map((p,C)=>o.default.createElement(u.Route,{key:`custom-route-${C}`,...p,element:p.element})),f?o.default.createElement(u.Route,{index:!0,element:o.default.createElement(t.CanAccess,{resource:"dashboard",action:"list",fallback:n!=null?n:o.default.createElement(t.ErrorComponent,null)},o.default.createElement(f,null))}):o.default.createElement(u.Route,{index:!0,element:o.default.createElement(u.Navigate,{to:r!=null?r:`/${(d=(i=e.find(p=>p.list))==null?void 0:i.route)==null?void 0:d.replace(/^\//,"")}`})}),...[...y||[]],o.default.createElement(u.Route,{path:"*",element:o.default.createElement(U,{route:""})})))},h=()=>a?o.default.createElement(a,null):o.default.createElement(t.LoginPage,null);return x?E():(()=>o.default.createElement(u.Routes,null,[...m||[]].map((i,d)=>o.default.createElement(u.Route,{key:`custom-route-${d}`,...i})),o.default.createElement(u.Route,{path:"/",element:h()}),o.default.createElement(u.Route,{path:"/login",element:h()}),o.default.createElement(u.Route,{path:"*",element:o.default.createElement(g,null)})))()};function J({children:r,...e}){return w.default.createElement(R.BrowserRouter,{...e},w.default.createElement(j,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}function X({children:r,...e}){return w.default.createElement(R.MemoryRouter,{...e},w.default.createElement(j,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}function D({children:r,...e}){return w.default.createElement(R.HashRouter,{...e},w.default.createElement(j,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),r)}var b=H(require("react")),F=require("react-router-dom");function ee(r,e=!0){let{navigator:n}=b.default.useContext(F.UNSAFE_NavigationContext);b.default.useEffect(()=>{if(!e)return;let f=n.go,a=n.push;return n.push=(...m)=>{r()!==!1&&a(...m)},n.go=(...m)=>{r()!==!1&&f(...m)},()=>{n.push=a,n.go=f}},[n,r,e])}function N(r,e=!0,n,f=!1){let a=b.default.useCallback(s=>(s.preventDefault(),s.returnValue=r,s.returnValue),[r]);b.default.useEffect(()=>(e&&!f&&window.addEventListener("beforeunload",a),()=>{window.removeEventListener("beforeunload",a)}),[a,e,f]);let m=b.default.useCallback(()=>{let s=window.confirm(r);return s&&n&&n(),s},[r]);ee(m,e)}var O=({message:r,when:e,setWarnWhen:n})=>(N(r,e,()=>{n==null||n(!1)},!0),null);var oe={useHistory:()=>{let r=(0,P.useNavigate)();return{push:r,replace:e=>{r(e,{replace:!0})},goBack:()=>{r(-1)}}},useLocation:P.useLocation,useParams:()=>{let r=(0,P.useParams)(),{pathname:e}=(0,P.useLocation)(),n=`/${Object.values(r).join("/")}`;return(0,z.handleUseParams)({...r,resource:Object.keys(r).length===0?e.substring(1):decodeURIComponent(e.substring(1)).replace(n,"")})},Prompt:O,Link:P.Link,RouterComponent:J},re=oe;
//# sourceMappingURL=legacy.js.map